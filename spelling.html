<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Little Master: Spelling</title>
    
    <!-- Kids Font & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Bubblegum+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Bubblegum Sans', cursive;
            background: linear-gradient(180deg, #CE93D8 0%, #F3E5F5 100%);
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            color: #333;
        }

        /* --- SCREENS --- */
        .screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            background: linear-gradient(180deg, #BA68C8 0%, #9C27B0 100%);
            z-index: 10;
        }

        /* --- BUTTONS --- */
        .home-btn {
            position: absolute; top: 15px; left: 15px;
            background: white; border: 3px solid #fff; border-radius: 50%;
            width: 45px; height: 45px; font-size: 24px;
            cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 200; text-decoration: none; display: flex;
            justify-content: center; align-items: center;
        }

        .big-btn {
            font-size: 28px; padding: 12px 30px; border-radius: 50px;
            border: none; cursor: pointer; color: white;
            font-family: 'Bubblegum Sans', cursive;
            box-shadow: 0 6px 0 rgba(0,0,0,0.2);
            transition: transform 0.1s; margin: 10px;
            min-width: 140px;
        }
        .big-btn:active { transform: translateY(5px); box-shadow: none; }
        
        .btn-start { background: #FF9800; font-size: 35px; padding: 15px 60px; }
        .btn-eng { background: #2196F3; }
        .btn-hin { background: #4CAF50; }

        /* --- GAME UI --- */
        #gameWrapper { 
            display: none; width: 100%; height: 100%; 
            align-items: center; justify-content: center; flex-direction: column;
            padding-bottom: 60px; /* Space for Bottom Ad */
        }
        
        .card {
            background: white; padding: 15px; border-radius: 30px;
            width: 90%; max-width: 380px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 6px solid #fff;
            display: flex; flex-direction: column; align-items: center;
            position: relative;
        }

        .question-img {
            font-size: 80px; height: 100px; margin: 5px 0;
            display: flex; align-items: center; justify-content: center;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1));
        }
        .img-mode { max-width: 120px; max-height: 100px; object-fit: contain; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1)); }

        /* ANSWER SLOTS */
        .answer-box {
            display: flex; gap: 6px; justify-content: center; flex-wrap: wrap;
            margin: 15px 0; min-height: 50px;
        }
        .slot {
            width: 48px; height: 48px; border-radius: 12px;
            background: #F3E5F5; border: 2px dashed #AB47BC;
            display: flex; align-items: center; justify-content: center;
            font-size: 26px; color: #6A1B9A; font-weight: bold;
        }
        .slot.filled { background: #E1BEE7; border: 2px solid #8E24AA; animation: pop 0.2s; }

        /* KEYBOARD */
        .keyboard-box {
            display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;
            margin-top: 10px; width: 100%;
        }
        .key-btn {
            width: 45px; height: 45px; border-radius: 10px;
            background: #FFEB3B; border: none;
            box-shadow: 0 4px 0 #FBC02D; color: #F57F17;
            font-size: 22px; font-family: 'Bubblegum Sans', cursive;
            cursor: pointer;
        }
        .key-btn:active { transform: translateY(4px); box-shadow: none; }
        .key-btn.used { opacity: 0; pointer-events: none; transform: scale(0); transition: all 0.2s; }

        /* CONTROLS */
        .controls { display: flex; gap: 15px; margin-top: 20px; width: 100%; justify-content: center; }
        
        .action-btn {
            padding: 10px 25px; border-radius: 30px; border: none;
            color: white; font-size: 20px; cursor: pointer;
            font-family: 'Bubblegum Sans', cursive;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2); width: 45%;
            display: flex; align-items: center; justify-content: center; gap: 5px;
        }
        .action-btn:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-clear { background: #FF5722; }
        .btn-check { background: #4CAF50; }

      

        .ad-bottom {
            position: fixed; bottom: 0; width: 100%; height: 60px;
            background: #fff; display: flex; justify-content: center;
            align-items: center; border-top: 2px solid #ddd; z-index: 9000;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
        }

        /* --- MODALS (ABCD Style) --- */
        .modal {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.85); display: none;
            justify-content: center; align-items: center; z-index: 500;
            backdrop-filter: blur(5px);
        }
        .modal-content { 
            background: white; padding: 30px; border-radius: 25px; 
            text-align: center; width: 85%; max-width: 320px;
            box-shadow: 0 20px 0 rgba(0,0,0,0.1);
            animation: slideUp 0.3s;
        }
        
        .modal-btn {
            padding: 12px 40px; font-size: 22px; border: none; border-radius: 50px;
            color: white; cursor: pointer; font-family: 'Bubblegum Sans', cursive;
            margin-top: 15px; width: 80%; box-shadow: 0 6px 0 rgba(0,0,0,0.2);
        }
        .modal-btn:active { transform: translateY(5px); box-shadow: none; }

        /* Specific Modal Styles */
        .btn-next { background: #2196F3; } /* Blue for Next */
        .btn-retry { background: #FF9800; } /* Orange for Retry */
        
        .modal-icon { font-size: 70px; margin-bottom: 10px; display: block; }
        .modal-title { font-size: 35px; margin: 0; }
        .txt-correct { color: #4CAF50; }
        .txt-wrong { color: #F44336; }

        @keyframes pop { 0%{transform:scale(0.5);} 100%{transform:scale(1);} }
        @keyframes slideUp { from{transform:translateY(50px); opacity:0;} to{transform:translateY(0); opacity:1;} }
        .shake { animation: shake 0.4s; }
        @keyframes shake { 0%,100%{transform:translateX(0);} 25%{transform:translateX(-10px);} 75%{transform:translateX(10px);} }
        
        #langScreen { display: none; }
    </style>
</head>
<body>

    <!-- 1. START SCREEN -->
    <div id="startScreen" class="screen">
        <a href="index.html" class="home-btn">üè†</a>
        <h1 style="color:white; font-size: 40px; margin-bottom: 10px;">Spelling Bee üêù</h1>
        
       

        <button class="big-btn btn-start" onclick="showLangScreen()">‚ñ∂ Start Game</button>
    </div>

    <!-- 2. LANGUAGE SCREEN -->
    <div id="langScreen" class="screen">
        <a href="index.html" class="home-btn">üè†</a>
        <h2 style="color:white; font-size: 30px; margin-bottom:10px;">Choose Language</h2>
        
      

        <div style="display:flex; gap:20px; width: 100%; justify-content: center; align-items: center;">
            <button class="big-btn btn-eng" onclick="setLanguage('en')">üî§ English</button>
            <button class="big-btn btn-hin" onclick="setLanguage('hi')">üïâÔ∏è Hindi</button>
        </div>
    </div>

    <!-- 3. GAME AREA -->
    <div id="gameWrapper">
        <a href="index.html" class="home-btn">üè†</a>
        <img src="talkingof.PNG" id="mascot" style="height:90px; margin-bottom:5px;">
        
        <div class="card" id="gameCard">
            <p style="margin:0; color:#888;">Spell this:</p>
            
            <div id="qImg"></div>

            <div class="answer-box" id="slotsArea"></div>

            <div class="keyboard-box" id="keysArea"></div>

            <!-- CONTROLS -->
            <div class="controls">
                <button class="action-btn btn-clear" onclick="clearInput()"><i class="fas fa-times"></i> Clear</button>
                <button class="action-btn btn-check" onclick="checkAnswer()"><i class="fas fa-check"></i> Check</button>
            </div>
        </div>
    </div>

   

    <!-- MODAL: WRONG -->
    <div id="wrongModal" class="modal">
        <div class="modal-content">
            <span class="modal-icon">üò¢</span>
            <h2 class="modal-title txt-wrong">Wrong!</h2>
            <button class="modal-btn btn-retry" onclick="closeModal()">Try Again</button>
        </div>
    </div>

    <!-- MODAL: CORRECT -->
    <div id="correctModal" class="modal">
        <div class="modal-content">
            <span class="modal-icon">üåü</span>
            <h2 class="modal-title txt-correct">Correct!</h2>
            <button class="modal-btn btn-next" onclick="nextLevel()">Next ‚ûî</button>
        </div>
    </div>

    <script>
        const gameData = [
            { img: "üê±", en: "CAT", hi: "‡§¨‡§ø‡§≤‡•ç‡§≤‡•Ä" },
            { img: "üê∂", en: "DOG", hi: "‡§ï‡•Å‡§§‡•ç‡§§‡§æ" },
            { img: "üåû", en: "SUN", hi: "‡§∏‡•Ç‡§∞‡§ú" },
            { img: "üçé", en: "APPLE", hi: "‡§∏‡•á‡§¨" },
            { img: "ü¶á", en: "BAT", hi: "‡§¨‡§≤‡•ç‡§≤‡§æ" },
            { img: "üöå", en: "BUS", hi: "‡§¨‡§∏" },
            { img: "üöó", en: "CAR", hi: "‡§ó‡§æ‡§°‡§º‡•Ä" },
            { img: "üêü", en: "FISH", hi: "‡§Æ‡§õ‡§≤‡•Ä" },
            { img: "üå≥", en: "TREE", hi: "‡§™‡•á‡§°‡§º" },
            { img: "ü¶Å", en: "LION", hi: "‡§∂‡•á‡§∞" },
            { img: "üêò", en: "ELEPHANT", hi: "‡§π‡§æ‡§•‡•Ä" },
            { img: "üêØ", en: "TIGER", hi: "‡§¨‡§æ‡§ò" },
            { img: "ü¶ì", en: "ZEBRA", hi: "‡§ú‡•á‡§¨‡§∞‡§æ" },
            { img: "üêí", en: "MONKEY", hi: "‡§¨‡§Ç‡§¶‡§∞" },
            { img: "üêá", en: "RABBIT", hi: "‡§ñ‡§∞‡§ó‡•ã‡§∂" },
            { img: "üêº", en: "PANDA", hi: "‡§™‡§æ‡§Ç‡§°‡§æ" },
            { img: "ü¶ä", en: "FOX", hi: "‡§≤‡•ã‡§Æ‡§°‡§º‡•Ä" },
            { img: "üêÑ", en: "COW", hi: "‡§ó‡§æ‡§Ø" },
            { img: "üêê", en: "GOAT", hi: "‡§¨‡§ï‡§∞‡•Ä" },
            { img: "ü¶Ü", en: "DUCK", hi: "‡§¨‡§§‡•ç‡§§‡§ñ" },
            { img: "ü¶â", en: "OWL", hi: "‡§â‡§≤‡•ç‡§≤‡•Ç" },
            { img: "ü¶ú", en: "PARROT", hi: "‡§§‡•ã‡§§‡§æ" },
            { img: "üêî", en: "HEN", hi: "‡§Æ‡•Å‡§∞‡•ç‡§ó‡•Ä" },
            { img: "üê¶‚Äç‚¨õ", en: "CROW", hi: "‡§ï‡•å‡§µ‡§æ" },
            { img: "ü¶ö", en: "PEACOCK", hi: "‡§Æ‡•ã‡§∞" },
            { img: "üê∑", en: "PIG", hi: "‡§∏‡•Å‡§Ö‡§∞" },
            { img: "üêª", en: "BEAR", hi: "‡§≠‡§æ‡§≤‡•Ç" },
            { img: "üêë", en: "SHEEP", hi: "‡§≠‡•á‡§°‡§º" },
            { img: "üêé", en: "HORSE", hi: "‡§ò‡•ã‡§°‡§º‡§æ" },
            { img: "üê∏", en: "FROG", hi: "‡§Æ‡•á‡§Ç‡§¢‡§ï" }
        ];

        let currentLang = 'en'; 
        let currentIndex = 0;
        let currentWord = "";
        let enteredChars = [];

        function showLangScreen() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('langScreen').style.display = 'flex';
        }

        function setLanguage(lang) {
            currentLang = lang;
            document.getElementById('langScreen').style.display = 'none';
            document.getElementById('gameWrapper').style.display = 'flex';
            currentIndex = 0; 
            loadLevel();
        }

        function playSound(text, isLetter = false) {
            const mascot = document.getElementById('mascot');
            if(mascot) mascot.src = "talkingof.gif";

            let fileName = "";
            let currentData = gameData[currentIndex];

            if(isLetter) {
                if(currentLang === 'en') fileName = text.toLowerCase() + ".mp3";
                else fileName = "TTS_ONLY"; 
            } else if (text === "Correct" || text === "Wrong") {
                fileName = "sys_" + text.toLowerCase() + ".mp3";
            } else {
                fileName = currentData.en.toLowerCase() + "Spelling.mp3";
            }

            let audio = new Audio(fileName);
            audio.onended = () => { if(mascot) mascot.src = "talkingof.PNG"; };
            
            audio.onerror = () => {
                const synth = window.speechSynthesis;
                let speakText = text;
                if(!isLetter && text !== "Correct" && text !== "Wrong") {
                     speakText = currentLang === 'en' ? currentData.en : currentData.hi;
                }
                const u = new SpeechSynthesisUtterance(speakText);
                u.lang = currentLang === 'hi' ? 'hi-IN' : 'en-US';
                u.rate = 0.9;
                u.onend = () => { if(mascot) mascot.src = "talkingof.PNG"; };
                synth.speak(u);
            };

            audio.play().catch(e => {
                const synth = window.speechSynthesis;
                const u = new SpeechSynthesisUtterance(text);
                u.onend = () => { if(mascot) mascot.src = "talkingof.PNG"; };
                synth.speak(u);
            });
        }

        function loadLevel() {
            if(currentIndex >= gameData.length) currentIndex = 0; 

            const data = gameData[currentIndex];
            currentWord = currentLang === 'en' ? data.en : data.hi;
            enteredChars = [];

            const imgBox = document.getElementById('qImg');
            if(data.img.includes('.')) {
                imgBox.innerHTML = `<img src="${data.img}" class="img-mode">`;
            } else {
                imgBox.innerHTML = `<div class="question-img">${data.img}</div>`;
            }

            setTimeout(() => playSound("MAIN"), 300);

            const slotsArea = document.getElementById('slotsArea');
            slotsArea.innerHTML = "";
            let charArray = Array.from(currentWord); 
            charArray.forEach((c, i) => {
                let slot = document.createElement('div');
                slot.className = 'slot';
                slot.id = 'slot-' + i;
                slotsArea.appendChild(slot);
            });

            let keys = [...charArray];
            if(currentLang === 'en') {
                const alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                keys.push(alpha[Math.floor(Math.random()*26)]);
                keys.push(alpha[Math.floor(Math.random()*26)]);
            } else {
                const hAlpha = "‡§ï‡§ñ‡§ó‡§ò‡§ö‡§õ‡§ú‡§ù‡§ü‡§†‡§°‡§¢‡§£‡§§‡§•‡§¶‡§ß‡§®‡§™‡§´‡§¨‡§≠‡§Æ‡§Ø‡§∞‡§≤‡§µ‡§∂‡§∑‡§∏‡§π";
                keys.push(hAlpha[Math.floor(Math.random()*hAlpha.length)]);
                keys.push(hAlpha[Math.floor(Math.random()*hAlpha.length)]);
            }
            keys.sort(() => Math.random() - 0.5);

            const keysArea = document.getElementById('keysArea');
            keysArea.innerHTML = "";
            keys.forEach((k, idx) => {
                let btn = document.createElement('button');
                btn.className = 'key-btn';
                btn.innerText = k;
                btn.id = 'key-' + idx;
                btn.onclick = () => handleKeyClick(k, btn);
                keysArea.appendChild(btn);
            });
        }

        function handleKeyClick(char, btn) {
            let maxLen = Array.from(currentWord).length;
            if(enteredChars.length < maxLen) {
                enteredChars.push(char);
                let slotIdx = enteredChars.length - 1;
                let slot = document.getElementById('slot-' + slotIdx);
                slot.innerText = char;
                slot.classList.add('filled');
                btn.classList.add('used');
                
                playSound(char, true);

                // AUTO CHECK
                if(enteredChars.length === maxLen) {
                    setTimeout(checkAnswer, 300);
                }
            }
        }

        function clearInput() {
            enteredChars = [];
            document.querySelectorAll('.slot').forEach(s => { s.innerText = ""; s.classList.remove('filled'); });
            document.querySelectorAll('.key-btn').forEach(k => { k.classList.remove('used'); });
        }

        function checkAnswer() {
            let attempt = enteredChars.join('');
            if(attempt === currentWord) {
                if(typeof confetti === 'function') confetti();
                playSound("Correct"); 
                document.getElementById('correctModal').style.display = 'flex';
            } else {
                playSound("Wrong"); 
                const card = document.getElementById('gameCard');
                card.classList.add('shake');
                setTimeout(() => card.classList.remove('shake'), 400);
                document.getElementById('wrongModal').style.display = 'flex';
            }
        }

        function closeModal() {
            document.getElementById('wrongModal').style.display = 'none';
            // Auto Clear on Retry
            clearInput();
        }

        function nextLevel() {
            document.getElementById('correctModal').style.display = 'none';
            currentIndex++;
            loadLevel();
        }
    </script>
</body>
</html>